{"ast":null,"code":"import { FormControl, FormGroup, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/service/requests.service\";\nimport * as i3 from \"ngx-toastr\";\nimport * as i4 from \"ngx-spinner\";\nimport * as i5 from \"../../../../shared/header/header.component\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"../../../../shared/footer/footer.component\";\nimport * as i8 from \"@angular/forms\";\n\nfunction SingleViewComponent_span_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r0.projectData == null ? null : ctx_r0.projectData.price);\n  }\n}\n\nfunction SingleViewComponent_span_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵelementStart(1, \"del\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.projectData == null ? null : ctx_r1.projectData.price);\n  }\n}\n\nfunction SingleViewComponent_span_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r2.projectData == null ? null : ctx_r2.projectData.discount_price);\n  }\n}\n\nfunction SingleViewComponent_div_14_small_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 21);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r5.validationFieldMessage.bidamount);\n  }\n}\n\nfunction SingleViewComponent_div_14_small_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 21);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r6.validationFieldMessage.days);\n  }\n}\n\nfunction SingleViewComponent_div_14_small_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 21);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r7.validationFieldMessage.proposal);\n  }\n}\n\nfunction SingleViewComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 1);\n    i0.ɵɵelementStart(1, \"div\", 10);\n    i0.ɵɵelementStart(2, \"h2\");\n    i0.ɵɵtext(3, \"Place a Bid on this Project\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"p\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 10);\n    i0.ɵɵelementStart(6, \"form\", 11);\n    i0.ɵɵlistener(\"submit\", function SingleViewComponent_div_14_Template_form_submit_6_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return ctx_r8.submitBidForm();\n    });\n    i0.ɵɵelementStart(7, \"div\", 12);\n    i0.ɵɵelementStart(8, \"label\", 13);\n    i0.ɵɵtext(9, \"Bid Amount\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(10, \"input\", 14);\n    i0.ɵɵtemplate(11, SingleViewComponent_div_14_small_11_Template, 2, 1, \"small\", 15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"div\", 12);\n    i0.ɵɵelementStart(13, \"label\", 16);\n    i0.ɵɵtext(14, \"This project will be delivered in\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(15, \"input\", 17);\n    i0.ɵɵtemplate(16, SingleViewComponent_div_14_small_16_Template, 2, 1, \"small\", 15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"div\", 12);\n    i0.ɵɵelementStart(18, \"label\", 18);\n    i0.ɵɵtext(19, \"Describe your proposal\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(20, \"textarea\", 19);\n    i0.ɵɵtemplate(21, SingleViewComponent_div_14_small_21_Template, 2, 1, \"small\", 15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"button\", 20);\n    i0.ɵɵtext(23, \"Submit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"formGroup\", ctx_r3.BidForm);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.validationField);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.validationField);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.validationField);\n  }\n}\n\nfunction SingleViewComponent_div_15_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 26);\n    i0.ɵɵtext(1, \"No Bids\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SingleViewComponent_div_15_div_5_button_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 34);\n    i0.ɵɵlistener(\"click\", function SingleViewComponent_div_15_div_5_button_2_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext(3);\n      return ctx_r14.editBig();\n    });\n    i0.ɵɵtext(1, \"Edit\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SingleViewComponent_div_15_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27);\n    i0.ɵɵelementStart(1, \"div\", 28);\n    i0.ɵɵtemplate(2, SingleViewComponent_div_15_div_5_button_2_Template, 2, 0, \"button\", 29);\n    i0.ɵɵelementStart(3, \"div\", 26);\n    i0.ɵɵelementStart(4, \"h4\", 30);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 31);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"div\", 32);\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 33);\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const bid_r12 = ctx.$implicit;\n    const ctx_r11 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", bid_r12.seller[0] == ctx_r11.sellerId);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(bid_r12.seller[1].fname + \" \" + bid_r12.seller[1].lname);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Amount: \", bid_r12.bidamount, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Time: \", bid_r12.days, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Proposal: \", bid_r12.proposal, \"\");\n  }\n}\n\nfunction SingleViewComponent_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 22);\n    i0.ɵɵelementStart(1, \"div\", 23);\n    i0.ɵɵelementStart(2, \"h2\");\n    i0.ɵɵtext(3, \"All Bids\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(4, SingleViewComponent_div_15_div_4_Template, 2, 0, \"div\", 24);\n    i0.ɵɵtemplate(5, SingleViewComponent_div_15_div_5_Template, 12, 5, \"div\", 25);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r4.bids);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r4.bids);\n  }\n}\n\nexport let SingleViewComponent = /*#__PURE__*/(() => {\n  class SingleViewComponent {\n    constructor(activeRoute, request, toastr, spinner) {\n      this.activeRoute = activeRoute;\n      this.request = request;\n      this.toastr = toastr;\n      this.spinner = spinner;\n      this.validationMapping = {\n        'bidamount': {\n          required: \"Bid Amount is required\"\n        },\n        'days': {\n          required: \"Days is required\"\n        },\n        'proposal': {\n          required: \"Proposal is required\"\n        }\n      };\n      this.validationField = false;\n      this.validationFieldMessage = {};\n    }\n\n    ngOnInit() {\n      this.spinner.show();\n      this.project_id = this.activeRoute.snapshot.params.id;\n      this.userData = localStorage.getItem(\"user-name\") ? localStorage.getItem(\"user-name\") : '';\n      this.userData = JSON.parse(this.userData ? this.userData : '');\n      this.sellerId = this.userData.id;\n      this.viewSingleProduct(this.project_id);\n      this.initializeForm();\n      this.showBids();\n      this.spinner.hide();\n    }\n\n    showBids() {\n      setInterval(() => {\n        this.request.Get(\"view-bids/\" + this.project_id).subscribe(res => {\n          this.bids = res.data;\n        }, err => {\n          console.log(err);\n        });\n      }, 5000);\n    }\n\n    initializeForm() {\n      this.BidForm = new FormGroup({\n        bidamount: new FormControl('', [Validators.required]),\n        days: new FormControl('', [Validators.required]),\n        proposal: new FormControl('', [Validators.required]),\n        seller: new FormControl(this.sellerId, [Validators.required]),\n        project_id: new FormControl(this.project_id, [Validators.required])\n      });\n    }\n\n    GetErrorsFromFormGroup(formgroup, errorMapping) {\n      var Errors = [];\n      Object.keys(formgroup.controls).forEach(key => {\n        var _a;\n\n        const controlErrors = (_a = formgroup.get(key)) === null || _a === void 0 ? void 0 : _a.errors;\n        if (controlErrors != null) Object.keys(controlErrors).forEach(keyError => {\n          Errors[key] = errorMapping[key][keyError];\n        });\n        setTimeout(() => {\n          this.validationField = false;\n          this.validationFieldMessage = \"\";\n        }, 3000);\n      });\n      return Errors;\n    }\n\n    viewSingleProduct(n) {\n      this.request.Get(\"view-single-product/\" + n).subscribe(res => {\n        this.projectData = res.data;\n      }, err => {\n        console.log(err);\n      });\n    }\n\n    submitBidForm() {\n      if (this.BidForm.valid) {\n        var url = 'add-bids';\n        this.request.Post(url, this.BidForm.value).subscribe(res => {\n          this.toastr.success(res.message);\n        }, err => {\n          console.log(err);\n          this.toastr.error(err.error.message);\n        });\n      } else {\n        if (this.GetErrorsFromFormGroup(this.BidForm, this.validationMapping)) {\n          this.validationField = true;\n          this.validationFieldMessage = this.GetErrorsFromFormGroup(this.BidForm, this.validationMapping);\n        }\n      }\n    }\n\n    editBig() {// this.request.Get(\"\")\n    }\n\n  }\n\n  SingleViewComponent.ɵfac = function SingleViewComponent_Factory(t) {\n    return new (t || SingleViewComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.RequestsService), i0.ɵɵdirectiveInject(i3.ToastrService), i0.ɵɵdirectiveInject(i4.NgxSpinnerService));\n  };\n\n  SingleViewComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SingleViewComponent,\n    selectors: [[\"app-single-view\"]],\n    decls: 17,\n    vars: 8,\n    consts: [[1, \"container\"], [1, \"row\"], [1, \"col-12\", \"text-center\"], [1, \"img-fluid\", 2, \"height\", \"500px\", 3, \"src\"], [1, \"col-md-5\", \"p-lg-5\", \"mx-auto\", \"my-5\", \"text-center\"], [1, \"display-4\", \"fw-normal\"], [4, \"ngIf\"], [1, \"lead\", \"fw-normal\", 3, \"innerHTML\"], [\"class\", \"row\", 4, \"ngIf\"], [\"class\", \"row mt-5\", 4, \"ngIf\"], [1, \"col-12\", \"border-1\"], [3, \"formGroup\", \"submit\"], [1, \"form-group\"], [\"for\", \"bidamout\"], [\"type\", \"text\", \"id\", \"bidamout\", \"placeholder\", \"Enter your bid amount\", \"formControlName\", \"bidamount\", 1, \"form-control\"], [\"class\", \"text-danger\", 4, \"ngIf\"], [\"for\", \"days\"], [\"type\", \"text\", \"id\", \"days\", \"placeholder\", \"Days\", \"formControlName\", \"days\", 1, \"form-control\"], [\"for\", \"proposal\"], [\"id\", \"proposal\", \"rows\", \"3\", \"placeholder\", \"What makes you the best candidate for this project?\", \"formControlName\", \"proposal\", 1, \"form-control\"], [1, \"btn\", \"btn-primary\"], [1, \"text-danger\"], [1, \"row\", \"mt-5\"], [1, \"col-12\"], [\"class\", \"\", 4, \"ngIf\"], [\"class\", \"col-12 d-flex p-4 border\", 4, \"ngFor\", \"ngForOf\"], [1, \"\"], [1, \"col-12\", \"d-flex\", \"p-4\", \"border\"], [1, \"bids-data\"], [\"class\", \"btn btn-primary text-white\", 3, \"click\", 4, \"ngIf\"], [1, \"name\"], [1, \"price\"], [1, \"day\"], [1, \"comment\"], [1, \"btn\", \"btn-primary\", \"text-white\", 3, \"click\"]],\n    template: function SingleViewComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"app-header\");\n        i0.ɵɵelementStart(1, \"main\");\n        i0.ɵɵelementStart(2, \"div\", 0);\n        i0.ɵɵelementStart(3, \"div\", 1);\n        i0.ɵɵelementStart(4, \"div\", 2);\n        i0.ɵɵelement(5, \"img\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"div\", 1);\n        i0.ɵɵelementStart(7, \"div\", 4);\n        i0.ɵɵelementStart(8, \"h1\", 5);\n        i0.ɵɵtext(9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(10, SingleViewComponent_span_10_Template, 2, 1, \"span\", 6);\n        i0.ɵɵtemplate(11, SingleViewComponent_span_11_Template, 3, 1, \"span\", 6);\n        i0.ɵɵtemplate(12, SingleViewComponent_span_12_Template, 2, 1, \"span\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(13, \"p\", 7);\n        i0.ɵɵtemplate(14, SingleViewComponent_div_14_Template, 24, 4, \"div\", 8);\n        i0.ɵɵtemplate(15, SingleViewComponent_div_15_Template, 6, 2, \"div\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(16, \"app-footer\");\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"src\", ctx.projectData == null ? null : ctx.projectData.image, i0.ɵɵsanitizeUrl);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(ctx.projectData == null ? null : ctx.projectData.name);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !(ctx.projectData == null ? null : ctx.projectData.discount_price));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.projectData == null ? null : ctx.projectData.discount_price);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.projectData == null ? null : ctx.projectData.discount_price);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"innerHTML\", ctx.projectData == null ? null : ctx.projectData.description, i0.ɵɵsanitizeHtml);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.userData.role == \"seller\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.userData.role == \"seller\");\n      }\n    },\n    directives: [i5.HeaderComponent, i6.NgIf, i7.FooterComponent, i8.ɵNgNoValidate, i8.NgControlStatusGroup, i8.FormGroupDirective, i8.DefaultValueAccessor, i8.NgControlStatus, i8.FormControlName, i6.NgForOf],\n    styles: [\".container[_ngcontent-%COMP%]{max-width:960px}.site-header[_ngcontent-%COMP%]{background-color:#000000d9;-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}.site-header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#8e8e8e;transition:color .15s ease-in-out}.site-header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#fff;text-decoration:none}.product-device[_ngcontent-%COMP%]{position:absolute;right:10%;bottom:-30%;width:300px;height:540px;background-color:#333;border-radius:21px;transform:rotate(30deg)}.product-device[_ngcontent-%COMP%]:before{position:absolute;top:10%;right:10px;bottom:10%;left:10px;content:\\\"\\\";background-color:#ffffff1a;border-radius:5px}.product-device-2[_ngcontent-%COMP%]{top:-25%;right:auto;bottom:0;left:5%;background-color:#e5e5e5}.flex-equal[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:1}@media (min-width: 768px){.flex-md-equal[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:1}}\"]\n  });\n  return SingleViewComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}